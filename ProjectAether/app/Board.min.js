var ProjectAether;(function(n){var t=function(){function t(t,i,r,u){var o,e,f,s,a,h,c,l;for(this.width=t,this.height=i,o=this,this._spaceLookup={},this.spaces=[],s=0,a=t*i,f=0;f<i;f++)for(e=0;e<t;e++)c=Math.floor(e+f/2),l=-f,h=new n.Space(l,c,s<a/2?r:u),this.spaces.push(h),this._spaceLookup["coord:"+c+l]=h,s++;this.rows=ko.computed(function(){return _.map(_.range(o.height),function(n){return o._getRow(n)})})}return t.prototype._getRow=function(n){for(var i=[],r=n*this.width,u=n*this.width+this.width,t=r;t<u;t++)i.push(this.spaces[t]);return i},t.prototype.getDistance=function(n,t,i,r){var u;if(typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r=Math.max(this.height,this.width)),i){var f=Math.abs(t.x-n.x),e=Math.abs(t.y-n.y),o=Math.abs(t.z()-n.z());return Math.max(f,e,o)}for(u=1;u<=r;){if(this.findEmptySquaresWithinXSteps(n,u).contains(t))return u;u=u+1}return null},t.prototype.findEmptySquaresWithinXSteps=function(n,t,i){var f,r,u;return(typeof i=="undefined"&&(i=!1),f=this,i)?(r=new HashSet,r.addAll(_.filter(this.spaces,function(i){return i.isEmpty()&&t>=f.getDistance(n,i,!0)})),r):(u=this._recursiveFindEmptySquaresWithinXSteps(n,t),u.remove(n),u)},t.prototype._recursiveFindEmptySquaresWithinXSteps=function(n,t,i){typeof i=="undefined"&&(i=null);var r=this;return i===null?i=new HashSet:i.add(n),t>0&&_.each(this._getEmptyNeighbors(n),function(n){r._recursiveFindEmptySquaresWithinXSteps(n,t-1,i)}),i},t.prototype.spacesAreAdjacent=function(n,t){return _.include(this._getNeighbors(n),t)},t.prototype._getNeighbors=function(n,t){typeof t=="undefined"&&(t=function(){return!0});var i=[this._getSpace(n.x+0,n.y+1),this._getSpace(n.x+1,n.y+0),this._getSpace(n.x+1,n.y-1),this._getSpace(n.x+0,n.y-1),this._getSpace(n.x-1,n.y+0),this._getSpace(n.x-1,n.y+1)];return _.filter(_.compact(i),t)},t.prototype._getEmptyNeighbors=function(n){return this._getNeighbors(n,function(n){return n.isEmpty()})},t.prototype._getSpace=function(n,t){return this._spaceLookup["coord:"+n+t]},t}();n.Board=t})(ProjectAether||(ProjectAether={}))